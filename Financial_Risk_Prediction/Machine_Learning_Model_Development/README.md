# **04. Machine Learning Model Development: Financial Risk Prediction**

이 단계는 2단계에서 계산된 재무 비율을 활용하여 기업의 재무 위험을 예측하는 머신러닝 모델을 개발하는 과정입니다. 회계 감사 관점에서, 이 모델은 잠재적인 재무적 부실 기업을 사전에 식별하여 감사 절차의 효율성을 높이는 데 기여할 수 있습니다.

#### **Summary of This Step**

1.  **목표 변수(Target Variable) 정의**: '재무 위험'이라는 추상적인 개념을 머신러닝 모델이 예측할 수 있는 구체적인 값으로 변환합니다.
2.  **데이터 분리**: 모델 훈련과 평가를 위해 전체 데이터를 훈련(Training) 세트와 테스트(Test) 세트로 나눕니다.
3.  **모델 선택 및 훈련**: 예측 목적에 맞는 적절한 머신러닝 모델을 선택하고, 훈련 세트를 사용하여 모델을 학습시킵니다.
4.  **모델 평가**: 테스트 세트로 모델의 성능을 평가하여 예측 정확도 및 신뢰성을 검증합니다.

#### **Detailed Descriptions**

##### **1. 목표 변수(Target Variable) 정의 및 데이터 준비**

머신러닝은 '입력 데이터(Feature)'를 바탕으로 '결과(Target)'를 예측하는 과정입니다. 이 프로젝트의 핵심은 '재무 위험'을 정의하는 것입니다.

  * **입력 데이터(Features)**: 2단계에서 계산된 모든 재무 비율들(`CurrentRatio`, `DebtRatio` 등)이 입력 데이터가 됩니다.
  * **목표 변수(Target Variable)**: '재무 위험'을 직접적으로 측정하기는 어렵습니다. 따라서 회계 실무에서 사용되는 \*\*대리 변수(Proxy Variable)\*\*를 사용해야 합니다. 예를 들어, \*\*'다음 연도에 순손실이 발생했는가?'\*\*를 목표 변수로 설정할 수 있습니다.
      * **코드 예시**:
        ```python
        # 다음 연도 순이익 데이터를 불러와서 목표 변수 생성
        # (이 부분은 데이터 구조에 따라 수정이 필요합니다)
        # 예: 순이익이 0보다 작으면 '1' (재무 위험), 아니면 '0' (정상)
        df['NetIncome_Next_Year'] = df.groupby('Ticker')['NetIncome'].shift(-1)
        df['FinancialRisk'] = (df['NetIncome_Next_Year'] < 0).astype(int)
        ```
      * 이렇게 목표 변수를 0 또는 1로 정의하면, 재무 위험을 예측하는 **분류(Classification) 문제**가 됩니다.

##### **2. 데이터 분리**

모델이 새로운, 보지 못했던 데이터에 대해 얼마나 잘 작동하는지 평가하기 위해 데이터를 두 그룹으로 나눕니다.

  * **훈련 세트(Training Set)**: 모델이 학습할 데이터. 전체 데이터의 70\~80%를 사용합니다.
  * **테스트 세트(Test Set)**: 모델의 성능을 평가할 데이터. 훈련에 사용되지 않은 나머지 20\~30%를 사용합니다.

##### **3. 모델 선택 및 훈련**

다양한 머신러닝 모델 중 재무 위험 예측에 적합한 모델을 선택합니다. 초기 단계에서는 직관적이고 성능이 좋은 모델을 사용하는 것이 좋습니다.

  * **로지스틱 회귀(Logistic Regression)**: 재무 위험 여부를 \*\*'예/아니오'\*\*로 예측하는 분류 문제에 가장 기본적이면서도 해석이 용이한 모델입니다. 각 재무 비율이 재무 위험에 미치는 영향력을 파악하기에 좋습니다.
  * **랜덤 포레스트(Random Forest)**: 여러 결정 트리를 결합하여 더 정확한 예측을 수행하는 모델입니다. 복잡한 비선형 관계를 잘 포착합니다.

##### **4. 모델 평가**

모델 훈련 후에는 테스트 세트를 사용하여 모델이 얼마나 정확하게 예측하는지 평가해야 합니다. 단순 정확도(Accuracy) 외에 감사 실무에 더 중요한 지표들이 있습니다.

  * **정밀도(Precision)**: 모델이 '재무 위험'이라고 예측한 기업들 중 **실제로 재무 위험 기업인 비율**을 나타냅니다. (과잉 감사 방지)
  * **재현율(Recall)**: **실제로 재무 위험 기업인 대상들 중** 모델이 '재무 위험'이라고 올바르게 예측한 비율을 나타냅니다. (위험 기업 누락 방지)
  * **F1-Score**: 정밀도와 재현율의 조화 평균으로, 두 지표를 모두 고려한 종합적인 성능 지표입니다.

이러한 평가 지표를 통해 모델의 실질적인 유용성을 판단할 수 있습니다.
