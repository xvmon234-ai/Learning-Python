# Day 11: 실전 모의고사 2회: 고급 데이터 처리 및 분석

## 🎯 학습 목표

  - Pandas를 활용하여 복잡한 데이터 병합, 전처리, 분석 문제를 해결하는 능력 강화.
  - 데이터 분석 결과를 적절한 시각화와 함께 설명하고 인사이트를 도출하는 과정 숙달.

### ✔️ 오늘 할 일

  - **실전 코딩 (약 2.5시간)**:
      - `고객 구매 데이터(CSV)`와 `상품 정보 데이터(Excel)`를 병합하고 전처리하는 문제 해결.
      - 문제 파악 및 계획 수립: 5분
      - 코딩 실행: 20분
      - 문제 풀이 마무리 및 코드 최적화: 나머지 시간
  - **자기 분석 및 설명 연습 (약 1.5시간)**:
      - 해결 과정을 말로 설명하는 연습을 하고 기록합니다.
      - 각 시각화(막대 그래프, 꺾은선 그래프)를 선택한 이유와 차트를 통해 도출한 인사이트를 상세히 작성합니다.

-----

### 📝 실습 문제 및 요구사항

#### 데이터 준비

아래 코드를 실행하여 실습에 사용할 데이터 파일을 생성합니다.

```python
import pandas as pd
import numpy as np

# 고객 구매 데이터 생성 (CSV)
cust_data = {
    'order_id': range(101, 201),
    'customer_id': np.random.choice(range(1, 21), 100),
    'product_id': np.random.choice(range(1001, 1016), 100),
    'purchase_date': pd.to_datetime(pd.date_range(start='2024-01-01', periods=100, freq='D')),
    'quantity': np.random.randint(1, 10, 100),
}
cust_df = pd.DataFrame(cust_data)
# 일부 결측치 및 이상치 추가
cust_df.loc[[10, 20], 'customer_id'] = np.nan
cust_df.loc[[30, 40], 'quantity'] = -1
cust_df.to_csv('customer_purchases.csv', index=False)

# 상품 정보 데이터 생성 (Excel)
prod_data = {
    'product_id': range(1001, 1016),
    'product_name': [f'상품_{i}' for i in range(1, 16)],
    'category': ['전자제품', '의류', '식품', '전자제품', '의류', '식품', '전자제품', '의류', '식품', '전자제품', '의류', '식품', '전자제품', '의류', '식품'],
    'price': np.random.randint(10000, 50001, 15)
}
prod_df = pd.DataFrame(prod_data)
prod_df.to_excel('product_info.xlsx', index=False)
```

#### 모의 문제

제공된 `customer_purchases.csv`와 `product_info.xlsx` 파일을 사용하여 다음을 수행하시오.

1.  **데이터 병합 및 전처리:**

      - 두 파일을 불러와 `product_id`를 기준으로 데이터를 병합하시오.
      - `customer_id`의 결측치를 'Unknown'으로 처리하시오.
      - `quantity`가 음수인 이상치를 1로 처리하시오.
      - `purchase_date` 열을 `datetime` 타입으로 변환하시오.

2.  **분석 및 시각화:**

      - **가장 많이 판매된 상품 카테고리 Top 5**를 찾고 막대 그래프로 시각화하시오.
      - **월별 총 매출액 추이**를 꺾은선 그래프로 시각화하시오. (매출액 = `quantity` \* `price`)

3.  **데이터 저장:**

      - **고객 연령대별 평균 구매 금액**을 계산하고, 이 결과를 새로운 `customer_age_summary.csv` 파일로 저장하시오. (고객 연령대 정보는 없으므로, `customer_id`를 활용하여 연령대를 임의로 그룹화하여 분석하시오. 예: ID 1-5는 10대, 6-10은 20대 등)

-----

### ✅ 결과물

#### ✍️ 문제 해결 과정

```python
# 문제 해결 코드를 여기에 붙여넣으세요.
```

#### 📊 시각화 결과

  - **Top 5 상품 카테고리:**
  - **월별 총 매출액 추이:**

#### 🧠 자기 분석 및 설명 연습

  - **시각화 선택 이유:**
    (막대 그래프와 꺾은선 그래프를 선택한 이유를 작성하세요.)
      - *"가장 많이 팔린 상품 카테고리는 항목별 비교가 중요하므로 막대 그래프가 적합하다고 판단했습니다. 월별 매출 추이는 시간 흐름에 따른 변화를 봐야 하므로 꺾은선 그래프를 선택했습니다."*
  - **도출된 인사이트:**
    (시각화 결과와 분석을 통해 알게 된 사실을 작성하세요.)
      - *"막대 그래프를 보니 '전자제품' 카테고리의 판매량이 압도적으로 높았습니다. 이는 해당 카테고리에 대한 집중적인 마케팅 전략이 유효함을 보여줍니다."*
      - *"꺾은선 그래프에서는 3월에 매출이 급격히 증가하는 추세를 보였습니다. 이는 특정 이벤트(예: 프로모션, 시즌 세일)의 영향을 받았을 가능성이 높습니다."*
  - **개선점 및 추가 분석 아이디어:**
    (문제 해결 과정에서 느꼈던 어려움과 더 해보고 싶은 분석을 작성하세요.)
      - *"데이터 병합 시 중복된 열 이름을 처리하는 것이 조금 헷갈렸습니다. 다음에는 병합 옵션을 더 정확히 숙지해야겠습니다."*
      - *"고객 연령대별 분석에서 '연령대' 정보가 없어 임의로 그룹화했는데, 실제 데이터가 있다면 더 정확한 분석이 가능했을 것입니다. 다음에는 고객의 구매 빈도나 재구매율을 추가로 분석해 보고 싶습니다."*
